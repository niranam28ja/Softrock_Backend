"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const http = require("http");
const os = require("os");
const path = require("path");
const lib_1 = require("../lib");
function run() {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const baseUrl = process.env['HOST'] || undefined;
        console.log(`Base url: ${baseUrl}`);
        const api = lib_1.createMoneySpace({
            baseUrl,
            credentials: lib_1.createFileCredentialsProvider(path.join(os.homedir(), '.moneyspace-test-creds.json')),
            successUrl: 'https://www.moneyspace.net/merchantapi/paycardsuccess',
            cancelUrl: 'https://www.moneyspace.net?status=cancel',
            failUrl: 'https://www.moneyspace.net?status=fail'
        });
        const port = 8080;
        const webHookHandler = api.createWebHookRequestHandler();
        const server = http.createServer((req, resp) => {
            webHookHandler(req, resp);
        });
        server
            .on('error', function (e) {
            console.error(e);
        })
            .listen({
            host: '0.0.0.0',
            port
        }, () => {
            console.log(`HTTP Server running at ${port} on 0.0.0.0`);
        });
    });
}
run();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLm1hbnVhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3Rlc3RzL2FwaS5tYW51YWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkJBQTZCO0FBQzdCLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFFN0IsZ0NBQXlFO0FBRXpFLFNBQWUsR0FBRzs7UUFDZCxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLFNBQVMsQ0FBQztRQUNqRCxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNwQyxNQUFNLEdBQUcsR0FBRyxzQkFBZ0IsQ0FBQztZQUN6QixPQUFPO1lBQ1AsV0FBVyxFQUFFLG1DQUE2QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxFQUFFLDZCQUE2QixDQUFDLENBQUM7WUFDbEcsVUFBVSxFQUFFLHVEQUF1RDtZQUNuRSxTQUFTLEVBQUUsMENBQTBDO1lBQ3JELE9BQU8sRUFBRSx3Q0FBd0M7U0FDcEQsQ0FBQyxDQUFDO1FBRUgsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLE1BQU0sY0FBYyxHQUFHLEdBQUcsQ0FBQywyQkFBMkIsRUFBRSxDQUFDO1FBQ3pELE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUU7WUFDM0MsY0FBYyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM5QixDQUFDLENBQUMsQ0FBQztRQUNILE1BQU07YUFDRCxFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQztZQUNwQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JCLENBQUMsQ0FBQzthQUNELE1BQU0sQ0FDSDtZQUNJLElBQUksRUFBRSxTQUFTO1lBQ2YsSUFBSTtTQUNQLEVBQ0QsR0FBRyxFQUFFO1lBQ0QsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsSUFBSSxhQUFhLENBQUMsQ0FBQztRQUM3RCxDQUFDLENBQ0osQ0FBQztJQWdCVixDQUFDO0NBQUE7QUFFRCxHQUFHLEVBQUUsQ0FBQyJ9